#!/bin/sh

# dependencies: notify-send, ponymix, sed

notifyMuted() {
	volume=`ponymix get-volume`
	dunstify -h string:x-canonical-private-synchronous:audio "Muted" -h int:value:"$volume" -t 1500 --icon audio-volume-muted
}

notifyAudio() {
	volume="$1"
    ponymix is-muted && notifyMuted && return

	if [ $volume -eq 0 ]; then
		notifyMuted
	elif [ $volume -le 30 ]; then
		dunstify -h string:x-canonical-private-synchronous:audio "Volume: " -h int:value:"$volume" -t 1500 --icon audio-volume-low
	elif [ $volume -le 70 ]; then
		dunstify -h string:x-canonical-private-synchronous:audio "Volume: " -h int:value:"$volume" -t 1500 --icon audio-volume-medium
	else
		dunstify -h string:x-canonical-private-synchronous:audio "Volume: " -h int:value:"$volume" -t 1500 --icon audio-volume-high
	fi
		# notify "volume: $volume%" -t 1500 --icon audio-volume-medium
		# notify "volume: $volume%" -t 1500 --icon audio-volume-high
}

notifyBrightness() {
	brightness="$1"
	if [ $brightness -eq 0 ]; then
		dunstify -h string:x-canonical-private-synchronous:brightness "Brightness: " -h int:value:"$brightness" -t 1500 --icon /usr/share/icons/Papirus-Dark/symbolic/status/display-brightness-off-symbolic.svg	
	elif [ $brightness -le 30 ]; then
		dunstify -h string:x-canonical-private-synchronous:brightness "Brightness: " -h int:value:"$brightness" -t 1500 --icon /usr/share/icons/Papirus-Dark/symbolic/status/display-brightness-low-symbolic.svg	
	elif [ $brightness -le 70 ]; then
		dunstify -h string:x-canonical-private-synchronous:brightness "Brightness: " -h int:value:"$brightness" -t 1500 --icon /usr/share/icons/Papirus-Dark/symbolic/status/display-brightness-medium-symbolic.svg	
	else
		dunstify -h string:x-canonical-private-synchronous:brightness "Brightness: " -h int:value:"$brightness" -t 1500 --icon /usr/share/icons/Papirus-Dark/symbolic/status/display-brightness-high-symbolic.svg	
	fi
}

input=`cat /dev/stdin`
echo "Received input"
case "$1" in
	muted)
		if [ "$input" -eq 0 ]
		then
			notifyAudio `ponymix get-volume`
			# notify "Unmuted" -t 1000 --icon audio-volume-high
			# echo unmuted
		else
			notifyMuted
			# echo muted
		fi
		;;
	audio)
		notifyAudio "$input"
		;;
	brightness)
		notifyBrightness "$input"
		;;
		
	*)
		echo "Not the right arguments"
		echo "$1"
		exit 2
esac
